/*
scrollTable v1.0
https://github.com/x2gboye/scrollTable
*/
;(function(e){function r(e){return e.find("> thead th").length>0?true:false}function i(e){return e.find("> tfoot td").length>0?true:false}function s(t){var n=t.height,r=jQuery.type(n);if(r==="string"){n=n.replace("%","");n=parseFloat(n);if(isNaN(n)||n>100){e.error("scrollTable() 'height' setting must be an int or a string with value of '0%' - '100%'")}else{n=n+"%"}}return{h:n,type:r}}function o(e,t){if(r(e)){var n=c(e,t),i=n.base.find("."+t.headerClass).outerHeight(),s=h(n.base.find("."+t.headerClass).css("border-top-width")),o=h(n.base.find("."+t.headerClass).css("border-bottom-width"));e.find("> thead th ."+t.thClass).css({"line-height":i-(s+o)+"px",top:s+"px"});n.base.css("padding-top",i+"px")}}function u(e,t){if(i(e)){var n=c(e,t),r=n.base.find("."+t.footerClass).outerHeight(),s=h(n.base.find("."+t.footerClass).css("border-top-width")),o=h(n.base.find("."+t.footerClass).css("border-bottom-width"));e.find("> tfoot td ."+t.tfClass).css({"line-height":r-(s+o)+"px",bottom:o+"px"});n.base.css("padding-bottom",r+"px")}}function a(e,t){var n=c(e,t),r=n.header.outerHeight(),i=n.footer.outerHeight(),o=h(n.base.css("border-top-width"))+h(n.base.css("border-bottom-width")),u=n.base.parent(),a=s(t),f=a.type==="string"?u.height():a.h;if(e.find("tbody").outerHeight()<f-r-i-o){n.base.height(e.find("tbody").outerHeight())}else{if(a.type==="string"){n.base.css("height",a.h)}else{n.base.height(t.height-r-i-o)}}}function f(e,t){var n=c(e,t),r=e.find("thead th ."+t.thClass);n.wrap.add(r).add(n.header).add(n.base).removeAttr("class");n.wrap.addClass(t.wrapClass);r.addClass(t.thClass);n.header.addClass(t.headerClass);n.base.addClass(t.baseClass);if(t.bordered){n.base.addClass(t.baseClass+"-bordered")}}function l(e,t,n){if(e.length>0&&t.length>0){var r=0,i=0,s=0;for($i=0;$i<e.length;$i++){var o=t[$i].css("paddingLeft"),u=t[$i].css("paddingRight"),a=e[$i].css("textAlign"),f=parseInt(e[$i].parent().attr("colspan"));if(f>1){r=f;for($z=i;$z<i+r;$z++){s+=t[$z].outerWidth()}}else{s+=t[i].outerWidth()}if(a==="center"){e[$i].width(s)}else if(a==="right"){u=u.replace("px","");e[$i].width(s-u)}else{e[$i].width(s);e[$i].css("padding-left",o)}if($i===e.length-1){e[$i].width(s-n)}if(r>0){i=i+r}else{i=i+1}r=0;s=0}}}function c(e,t){var n=e.closest("."+t.baseClass),r=n.find("."+t.wrapClass),i=n.find("."+t.headerClass),s=n.find("."+t.footerClass);return{base:n,wrap:r,header:i,footer:s}}function h(e){return parseInt(e.replace("px",""))}var t={baseClass:"ui-scrollTable",wrapClass:"ui-scrollTable-wrapper",headerClass:"ui-scrollTable-header",footerClass:"ui-scrollTable-footer",thClass:"th-inner",tfClass:"tf-inner",height:300,bordered:false};var n={init:function(s){return this.each(function(){var o=e(this);if(o.is("table")){var u=e.extend({},t);if(s){u=e.extend(u,s)}o.data("scrollTable-settings",u);if(!o.data("scrollTable-init")){var a,l,c,h,p,d,v;o.wrap('<div class="'+u.baseClass+'">');l=o.parent();if(u.bordered){l.addClass(u.baseClass+"-bordered")}if(i(o)){l.prepend('<div class="'+u.footerClass+'">');h=o.find("> tfoot td");h.each(function(){if(e.trim(e(this).html())===""){e(this).html("&nbsp;")}});h.wrapInner('<div class="'+u.tfClass+'">')}if(r(o)){l.prepend('<div class="'+u.headerClass+'">');c=o.find("> thead th");c.each(function(){if(e.trim(e(this).html())===""){e(this).html("&nbsp;")}});c.wrapInner('<div class="'+u.thClass+'">')}o.wrap('<div class="'+u.wrapClass+'">');e(window).resize(function(){clearTimeout(a);a=setTimeout(m,250)});function m(){n.resize.apply(o)}o.data("scrollTable-init",true);n.resize.apply(o)}else{f(o,u);n.resize.apply(o)}}else{console.log("Cannnot use scrollTable() on a non-TABLE element")}})},resize:function(){return this.each(function(){var t=e(this);if(t.data("scrollTable-init")){var n=t.data("scrollTable-settings"),r=c(t,n),i=h(r.base.css("border-right-width")),s=new Array,f=new Array,p=new Array;t.find("thead th ."+n.thClass).each(function(){s.push(e(this))});t.find("tfoot td ."+n.tfClass).each(function(){f.push(e(this))});t.find("tbody tr:first-child td").each(function(){p.push(e(this))});l(s,p,i);l(f,p,i);o(t,n);u(t,n);a(t,n)}})},destroy:function(){return this.each(function(){var t=e(this);if(t.data("scrollTable-init")){var n=t.data("scrollTable-settings"),r=c(t,n);r.header.remove();t.find("."+n.thClass).each(function(){e(this).replaceWith(this.childNodes)});r.footer.remove();t.find("."+n.tfClass).each(function(){e(this).replaceWith(this.childNodes)});t.unwrap();t.unwrap().removeData("scrollTable-init")}})}};e.fn.scrollTable=function(t){if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on scrollTable")}}})(jQuery);